`torch_dtype` is deprecated! Use `dtype` instead!
✓ Using GPU: NVIDIA GeForce RTX 2070 SUPER
  VRAM: 8.2GB
================================================================================
COMPREHENSIVE EVALUATION: PHI-2 + TOROIDAL ATTENTION
================================================================================

[1/3] Loading model...
Loading Phi-2 model: microsoft/phi-2
  Model config:
    Hidden size: 2560
    Num attention heads: 32
    Num hidden layers: 32
    Vocab size: 51200
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 26.99it/s]
  Model loaded on device: cpu
  Total parameters: 2,779,683,840
  Trainable parameters: 2,779,683,840
  Moving model to cuda...
  ✓ Model ready on cuda

[3/3] Running evaluations...

[Perplexity] Evaluating on wikitext2/test...
Computing perplexity:   0%|          | 0/200 [00:00<?, ?it/s]Computing perplexity:   1%|          | 2/200 [00:00<00:28,  6.90it/s]Computing perplexity:   2%|▎         | 5/200 [00:00<00:13, 14.14it/s]Computing perplexity:   6%|▋         | 13/200 [00:00<00:06, 29.92it/s]Computing perplexity:   9%|▉         | 18/200 [00:00<00:05, 32.55it/s]Computing perplexity:  18%|█▊        | 35/200 [00:00<00:02, 64.69it/s]Computing perplexity:  22%|██▏       | 43/200 [00:00<00:02, 65.47it/s]Computing perplexity:  25%|██▌       | 50/200 [00:01<00:03, 47.87it/s]Computing perplexity:  28%|██▊       | 56/200 [00:01<00:02, 48.20it/s]Computing perplexity:  31%|███       | 62/200 [00:01<00:03, 45.96it/s]Computing perplexity:  34%|███▍      | 68/200 [00:01<00:02, 47.63it/s]Computing perplexity:  37%|███▋      | 74/200 [00:01<00:02, 49.93it/s]Computing perplexity:  40%|████      | 80/200 [00:01<00:02, 52.27it/s]Computing perplexity:  43%|████▎     | 86/200 [00:01<00:02, 52.98it/s]Computing perplexity:  46%|████▌     | 92/200 [00:02<00:02, 47.04it/s]Computing perplexity:  49%|████▉     | 98/200 [00:02<00:02, 49.28it/s]Computing perplexity:  52%|█████▏    | 104/200 [00:02<00:02, 42.12it/s]Computing perplexity:  55%|█████▍    | 109/200 [00:02<00:02, 35.28it/s]Computing perplexity:  56%|█████▋    | 113/200 [00:02<00:02, 35.15it/s]Computing perplexity:  60%|██████    | 120/200 [00:02<00:02, 39.74it/s]Computing perplexity:  63%|██████▎   | 126/200 [00:02<00:01, 40.96it/s]Computing perplexity:  66%|██████▌   | 131/200 [00:03<00:01, 41.26it/s]Computing perplexity:  68%|██████▊   | 136/200 [00:03<00:01, 40.47it/s]Computing perplexity:  70%|███████   | 141/200 [00:03<00:01, 42.39it/s]Computing perplexity:  73%|███████▎  | 146/200 [00:03<00:01, 38.51it/s]Computing perplexity:  76%|███████▋  | 153/200 [00:03<00:01, 44.78it/s]Computing perplexity:  80%|████████  | 160/200 [00:03<00:00, 51.03it/s]Computing perplexity:  83%|████████▎ | 166/200 [00:03<00:00, 50.68it/s]Computing perplexity:  90%|█████████ | 180/200 [00:03<00:00, 69.90it/s]Computing perplexity:  94%|█████████▍| 188/200 [00:04<00:00, 52.35it/s]Computing perplexity:  97%|█████████▋| 194/200 [00:04<00:00, 43.47it/s]Computing perplexity: 100%|█████████▉| 199/200 [00:04<00:00, 38.85it/s]Computing perplexity: 100%|██████████| 200/200 [00:04<00:00, 44.05it/s]

================================================================================
Results saved to: results/evaluation/baseline_gpu.json
================================================================================

RESULTS SUMMARY:
--------------------------------------------------------------------------------

WIKITEXT2:
  perplexity: 13895.95726673042
  loss: 9.539353232695316
  num_tokens: 11799
